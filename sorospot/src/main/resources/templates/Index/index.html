<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <title th:text="${pageTitle}">Sorospot</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
    <link rel="stylesheet" th:href="@{/css/utils/variables.css}" />
    <link rel="stylesheet" th:href="@{/css/index/modals.css}" />
    <link rel="stylesheet" th:href="@{/css/index/map.css}" />
    <link rel="stylesheet" th:href="@{/css/utils/header.css}" />
  </head>

  <body>
    <th:block th:insert="~{utils/_header :: header}"></th:block>

    <th:block th:insert="fragments/index/_pinModal :: pinModal"></th:block>
    <th:block
      th:insert="fragments/index/_deleteModal :: deleteModal"
    ></th:block>
    <th:block
      th:insert="fragments/index/_myPinsModal :: myPinsModal"
    ></th:block>
    <th:block th:insert="fragments/index/_editModal :: editModal"></th:block>

    <main>
      <th:block th:insert="${contentTemplate} :: content"></th:block>
    </main>

    <script th:inline="javascript">
      /*<![CDATA[*/
      // expose Thymeleaf variables on window for external JS
      window.SOROSPOT_GOOGLE_MAPS_API_KEY = /*[[${googleMapsApiKey}]]*/ "";
      window.SOROSPOT_CURRENT_USER_EMAIL =
        /*[[${currentUserEmail}]]*/ "demo@sorospot.local";
      /*]]>*/
    </script>

    <script th:src="@{/js/index/map.js}" defer></script>
    <script th:src="@{/js/index/images.js}" defer></script>

    <script>
      window.delayedInitMap = function () {
        setTimeout(() => {
          window.initMap();
        }, 1000);
      };
    </script>

    <script
      th:src="|https://maps.googleapis.com/maps/api/js?key=${googleMapsApiKey}&callback=delayedInitMap|"
      async
      defer
    ></script>
  </body>
</html>
